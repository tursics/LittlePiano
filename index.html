<!doctype html>
<html>
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<meta name="msapplication-tap-highlight" content="no" />
	<script type="text/javascript" charset="utf-8" src="soundLib.js"></script>
	<script type="text/javascript" charset="utf-8" src="piano.js"></script>
</head>
<body>
<div id="log"></div>
<script type="text/javascript">
	document.getElementById('log').innerHTML = 'Ready to start';

	window.addEventListener('load', init, false);

	function init()
	{
		var sound = new SoundLib();
		if( sound.isOk()) {
			document.getElementById('log').innerHTML = 'Loading music...';

			sound.loadAssets([
				// convert youtube to mp3: http://www.youtube-mp3.org/de
//				'assets/berlinerluft.mp3', // http://www.youtube.com/watch?v=KMU0tzLwhbE
//				'assets/9000g.wav',        // file://wxWidgets/samples/sound
				'assets/stephan.mp3',
			], function() {
				addStartButton( sound);
			});
		} else {
			document.getElementById('log').innerHTML = '.mp3 files are not supported in this browser';
		}
	}

	function addStartButton(sound)
	{
		var str = '';
		str += '<button id="start">Start</button>';
		document.getElementById('log').innerHTML = str;

		document.getElementById('start').onclick = function() {
			playMusic(sound);
		};
	}

	function playMusic(sound)
	{
		var str = '';
		str += 'Volume: <input id="volume" type="range" value="100" max="100" min="0"><br>';
		str += 'Speed:  <input id="speed"  type="range" value="100" max="200" min="1"><br>';
		document.getElementById('log').innerHTML = str;

		var mainSound = sound.play(0);
		mainSound.source.loop = true;

		document.getElementById('volume').oninput = function() {
			sound.setVolume(mainSound, this.value / 100);
			console.log('Sound volume: ' + sound.getVolume(mainSound));
		};

		document.getElementById('speed').oninput = function() {
			sound.setSpeed(mainSound, this.value / 100);
			console.log('Sound speed: ' + sound.getSpeed(mainSound));
		};
	}

</script>
</body>
</html>
